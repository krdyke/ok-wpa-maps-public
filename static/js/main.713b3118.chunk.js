(this["webpackJsonpok-wpa-maps"]=this["webpackJsonpok-wpa-maps"]||[]).push([[0],{11:function(e,t,a){e.exports=a(19)},16:function(e,t,a){},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(10),o=a.n(r),l=(a(16),a(5)),s=a(2),c=a(3),u=a(6),d=a(7),m=a(1),p=a(4);function w(e){return Math.floor(Math.random()*Math.floor(e))}var f=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).WPATilesUrl="https://tiles.arcgis.com/tiles/jWQlP64OuwDh6GGX/arcgis/rest/services/_wpa_all_6Aug2020/MapServer",n.WPAMapsLandParcelsUrl="https://services1.arcgis.com/jWQlP64OuwDh6GGX/arcgis/rest/services/WPA_Maps_Land_Parcels/FeatureServer/0",n.sectionsLayerUrl="https://services1.arcgis.com/jWQlP64OuwDh6GGX/ArcGIS/rest/services/Oklahoma_Public_Land_Survey_Sections/FeatureServer/0",n.mapRef=i.a.createRef(),n.workflow=e.workflow,n.editThis=n.editThis.bind(Object(m.a)(n)),n.sayThanks=n.sayThanks.bind(Object(m.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(p.loadModules)(["esri/Map","esri/Basemap","esri/views/MapView","esri/layers/FeatureLayer","esri/widgets/Feature","esri/layers/TileLayer","esri/widgets/Editor","esri/core/watchUtils","esri/widgets/AreaMeasurement2D"],{css:!0}).then((function(t){var a=Object(l.a)(t,9),n=a[0],i=a[1],r=a[2],o=a[3],s=(a[4],a[5]),c=a[6],u=a[7],d=(a[8],new s({url:e.WPATilesUrl}));e.map=new n({basemap:new i({baseLayers:[d]})}),e.view=new r({container:e.mapRef.current,map:e.map,highlightOptions:{color:"#fe5c00",fillOpacity:.1},popup:{dockEnabled:!0,dockOptions:{buttonEnabled:!1,breakpoint:!1}},center:[-98.5,35.5],zoom:8});var m={title:"Please doublecheck the info below.",content:[{type:"fields",fieldInfos:[{fieldName:"OwnerLastName",label:"Owner's Last Name (if an individual)"},{fieldName:"OwnerFirstNameAndMI",label:"Owner's First Name or initials (if an individual)"},{fieldName:"OwnerOrgName",label:"Owner (if an entity or organization)"},{fieldName:"LandValue",label:"Land Value"},{fieldName:"ImprovementsValue2",label:"Improvements Value"},{fieldName:"TaxExempt",label:"Marked with an X?"}]}],overwriteActions:!0,actions:[{title:"Looks good!",id:"this-looks-ok",className:"esri-icon-check-mark"},{title:"Edit feature",id:"edit-this",className:"esri-icon-edit"}]},p=new o({url:e.WPAMapsLandParcelsUrl,popupTemplate:m,formTemplate:{title:"Land Info",elements:[{type:"group",label:"Owner Information",elements:[{type:"field",fieldName:"OwnerLastName",label:"Owner's Last Name (if an individual)"},{type:"field",fieldName:"OwnerFirstNameAndMI",label:"Owner's First Name or initials (if an individual)"},{type:"field",fieldName:"OwnerOrgName",label:"Owner (if an entity or organization)"}]},{type:"group",label:"Land and Improvement Valuation",elements:[{type:"field",fieldName:"LandValue",label:"Land Value"},{type:"field",fieldName:"ImprovementsValue2",label:"Improvements Value"}]},{type:"field",fieldName:"TaxExempt",label:"Marked with an X?"}]},groupDisplay:"sequential"});console.log(p),p.on("edits",(function(e){console.log(e)})),e.editor=new c({view:e.view,allowedWorkflows:[e.workflow],supportingWidgetDefaults:{featureForm:{groupDisplay:"sequential",fieldConfig:[{name:"OwnerLastName",label:"Owner's Last Name (if an individual)",required:!1},{name:"OwnerFirstNameAndMI",label:"Owner's First Name or initials (if an individual)",required:!1},{name:"OwnerOrgName",label:"Owner (if an entity or organization)",required:!1},{name:"LandValue",label:"Land Value",required:!1},{name:"ImprovementsValue2",label:"Improvements Value",required:!1},{name:"TaxExempt",label:"Marked with an X?",required:!1}]}},layerInfos:[{view:e.view,layer:p,allowAttachments:!1,deleteEnabled:!1}]}),e.editor.postInitialize=function(){u.init(this,"messages",(function(e){e.widgetLabel="WPA Maps",e.addFeature="Draw a new shape",e.editFeature="Review an existing record"}))};var f,h=e;if(e.view.popup.on("trigger-action",(function(e){"edit-this"===e.action.id&&h.editThis(),"this-looks-ok"===e.action.id&&h.sayThanks()})),"create"===e.workflow){var v=w(70915),b=new o({url:e.sectionsLayerUrl,definitionExpression:"OBJECTID = "+v});b.when((function(){return b.queryExtent()})).then((function(t){e.view.goTo(t.extent)})),e.map.add(b),p.popupEnabled=!1,e.view.ui.add(e.editor,"bottom-right")}"update"===e.workflow&&p.queryObjectIds().then((function(t){f=w(t.length-1),p.definitionExpression="OBJECTID = "+t[f],p.when((function(){return p.queryFeatures()})).then((function(t){e.view.goTo(t.features[0].geometry.extent)}))})),e.map.add(p)}))}},{key:"sayThanks",value:function(){alert("thank you"),this.view.popup.close()}},{key:"editThis",value:function(){var e=this.view,t=this.editor;e.when((function(){t.viewModel.activeWorkFlow||(e.popup.visible=!1,t.startUpdateWorkflowAtFeatureEdit(e.popup.selectedFeature),e.ui.add(t,"bottom-right"),e.popup.spinnerEnabled=!1),setTimeout((function(){var a=t.domNode.getElementsByClassName("esri-editor__back-button esri-interactive");1===a.length&&(a[0].setAttribute("title","Cancel edits, return to popup"),a[0].addEventListener("click",(function(a){a.preventDefault(),e.ui.remove(t)})))}),150)}))}},{key:"componentWillUnmount",value:function(){this.view&&(this.view.container=null)}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"webmap",ref:this.mapRef}))}}]),a}(i.a.Component),h=(a(17),a(18),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={welcomeScreen:!0,credentials:!1},n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){console.log("componentDidUpdate:"),console.log(t),console.log(this.state)}},{key:"componentDidMount",value:function(){var e=this;Object(p.loadModules)(["esri/identity/OAuthInfo","esri/identity/IdentityManager"],{css:!0}).then((function(t){var a=Object(l.a)(t,2),n=a[0],i=a[1],r=new n({appId:"l3OWRmRCGfkAN4Dh",portalUrl:"http://osu-geog.maps.arcgis.com/",popup:!1});i.registerOAuthInfos([r]),i.checkSignInStatus(r.portalUrl+"/sharing").then((function(t){console.log(t),e.setState({credentials:t})})).catch(i.getCredential(r.portalUrl+"/sharing"))}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},this.state.welcomeScreen&&i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",null,"Choose your path:"),i.a.createElement("button",{onClick:function(){return e.setState({welcomeScreen:!1,workflow:"create"})}},i.a.createElement("calcite-icon",{scale:"l",class:"big-icon",icon:"addInNew"}),i.a.createElement("br",null),"Draw some shapes"),i.a.createElement("h2",null,"or"),i.a.createElement("button",{onClick:function(){return e.setState({welcomeScreen:!1,workflow:"update"})}},i.a.createElement("calcite-icon",{scale:"l",class:"big-icon",icon:"editAttributes"}),i.a.createElement("br",null),"Review existing shapes")),!this.state.welcomeScreen&&i.a.createElement(f,{workflow:this.state.workflow}))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.713b3118.chunk.js.map